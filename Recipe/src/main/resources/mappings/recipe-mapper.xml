<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="recipeDAO">
	
	<insert id="insertRecipe" parameterType="Map">
		<selectKey resultType="int" keyProperty="recipeno" order="BEFORE">
			select sq_recipeno.nextval from dual
		</selectKey>
		INSERT INTO RECIPE (RECIPENO, CATEGORY, SUBJECT, WRITTEN, CONTENT, REGDATE, ID)
		VALUES (#{recipeno}, #{category}, #{subject}, #{written}, #{content}, SYSDATE, #{id})
	</insert>
	
	<insert id="insertRimage" parameterType="rimage">
		<selectKey resultType="int" keyProperty="rimageFileNo" order="BEFORE">
			select sq_rimgno.nextval from dual
		</selectKey>
		<![CDATA[
		INSERT INTO RECIPEIMG (RIMAGEFILENO, RIMAGEFILENAME, RECIPENO) 
		VALUES (#{rimageFileNo}, #{rimageFileName}, #{recipeno})
		]]>
	</insert>
	
	<select id="idChk" parameterType="int" resultType="String">
		SELECT ID FROM RECIPE
		WHERE RECIPENO = #{recipeno}
	</select>
	
	<update id="updateRecipe" parameterType="recipe">
		UPDATE RECIPE 
		SET SUBJECT = #{subject}, CONTENT = #{content}, FILENAME = #{filename}
		WHERE RECIPENO = #{recipeno}
	</update>
	
	<delete id="deleteRecipe" parameterType="int">
		DELETE FROM RECIPE WHERE RECIPENO = #{recipeno}
	</delete>
	
	<select id="getRecipeList" resultType="recipe">
		SELECT * FROM RECIPE
	</select>
	
	<select id="getMyrecipeList" parameterType="String" resultType="recipe">
		SELECT * FROM RECIPE WHERE ID = #{id}
	</select>
	
	<select id="getRecipe" parameterType="int" resultType="recipe">
		SELECT * FROM RECIPE WHERE RECIPENO = #{recipeno}
	</select>
	
</mapper>